[phases.setup]
nixpkgs = ["jdk21", "maven"]

[phases.install]
cmds = [
    "cat > src/main/resources/application.properties << 'EOF'",
    "bot.token=${BOT_TOKEN}",
    "bot.name=${BOT_NAME}",
    "db.url=jdbc:${DB_URL}",
    "db.username=${DB_USERNAME}",
    "db.password=${DB_PASSWORD}",
    "server.port=${PORT:-8080}",
    "EOF",
    "mvn -q -Dmaven.test.skip=true clean package"
]

[phases.build]
# Можно вообще опустить, Nixpacks сам найдёт jar, но если хочешь:
cmds = []

[start]
cmd = "java -Dserver.port=${PORT} -jar target/*jar"

[variables]
PORT = "8080"

[start]
cmd = "java -jar target/*.jar"
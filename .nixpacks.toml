[phases.setup]
cmds = [
    "mise use --global java@temurin-21",
    "mise use --global maven"
]

[phases.install]
cmds = [
    "cat > src/main/resources/application.properties << 'EOF'",
    "bot.token=${BOT_TOKEN}",
    "bot.name=${BOT_NAME}",
    "db.url=jdbc:${DB_URL}",
    "db.username=${DB_USERNAME}",
    "db.password=${DB_PASSWORD}",
    "server.port=${PORT:-8080}",
    "EOF",
    "mvn clean install -DskipTests"
]

[phases.build]
cmds = ["mvn package -DskipTests"]

[variables]
PORT = "8080"

[start]
cmd = "java -jar target/*.jar"